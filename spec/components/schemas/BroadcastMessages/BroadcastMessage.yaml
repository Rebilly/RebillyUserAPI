type: object
required:
  - emails
  - startSendingTime
properties:
  id:
    description: The broadcast message's identifier string
    readOnly: true
    allOf:
      - $ref: "#/components/schemas/ResourceId"
  criteria:
    $ref: "#/components/schemas/Condition"
  title:
    type: string
    description: The title of the messages. (This title will appear in reports.)
  messages:
    type: array
    description: >
      An array of message templates with the language locale identifiers according to [RFC 5646](https://tools.ietf.org/html/rfc5646).
      A language will be selected based on the customer's locale.


      If there is no locale set for the customer, then `en-US` (US English) will be used as the locale.


      If there is no template with the customer's locale,
      then a template locale will be selected by Rebilly using a closest
      match algorithm (which may be random at worst).


      If your email message templates are localized into more than one language,
      you SHOULD set a customer locale.


      An invalid placeholder will render to an empty string.
      For example, `Hello {{invalid.placeholder}}!`  will be rendered to `Hello !`.
    minItems: 1
    items:
      type: object
      example:
        locale: fr-FR
        version: "Version-A"
        from: "example@example.com"
        subject: Sujet de démonstration
        text: Texte de démonstration
        html: <p>Texte de démonstration</p>
        weight: 80
      properties:
        version:
          type: string
          description: The message version. (By default is empty, but if you make multiple versions, you can name or number them to distinguish them.)
        from:
          type: string
          description: >
            The sender address. It must be a **verified** address.
            # todo add a link to help docs on how to verify an email address
          maxLength: 254
        subject:
          type: string
          description: The message subject. The template placeholders are allowed.
          maxLength: 998
        text:
          type: string
          description: |
            The message's text body.
            Leave empty to use content from "html".
            The template placeholders are allowed.
        html:
          type: string
          description: |
            The message's html body.
            Leave empty to use content from "text".
            The template placeholders are allowed.
        locale:
          type: string
          description: The language locale identifier according to [RFC 5646](https://tools.ietf.org/html/rfc5646).
          example: fr-FR
        weight:
          type: integer
          description: >
            The value for random-weighted picking of a template in the case of a split test.

            The split test algorithm does not factor localization when
            making a weighted-random template selection.  Therefore, a version
            will be selected first, and then after a version is selected a specific
            localization will be selected.  Take the case where two versions have
            different locale content -- the locales of the content is not considered
            when selecting the version.
          minimum: 0
          maximum: 100
          example: 75
          default: 100
      required:
        - from
        - subject
        - text
        - html
        - locale
  splitTestStartTime:
    readOnly: true
    type: string
    format: date-time
    description: The split test start time
  startSendingTime:
    type: string
    format: date-time
    description: The start sending time
  status:
    readOnly: true
    type: string
    description: The broadcast message's status
    enum:
      - draft
      - sending
      - sent
      - archived
  createdTime:
    description: The broadcast message's created time
    allOf:
      - $ref: "#/components/schemas/ServerTimestamp"
  updatedTime:
    description: The broadcast message's updated time
    allOf:
      - $ref: "#/components/schemas/ServerTimestamp"
  _links:
    type: array
    description: The links related to the resource
    readOnly: true
    minItems: 1
    items:
      $ref: "#/components/schemas/SelfLink"
